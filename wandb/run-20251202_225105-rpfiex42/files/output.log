
Config (112 cores optimized):
  Devices: 112 TPU cores (v5e 256)
  Global batch size: 7168
  Batch per device: 64
  Steps per epoch: 1065
  Data loading: HuggingFace streaming + Prefetch

============================================================
WARNING:2025-12-02 22:51:06,165:jax._src.xla_bridge:798: A Google TPU may be present on this machine, but either a TPU-enabled jaxlib or libtpu is not installed. Falling back to cpu.
Available devices: 1
Device type: cpu

============================================================
Loading text embedding model...
============================================================
sentence-transformers not installed, falling back to transformers
Traceback (most recent call last):
  File "/home/mkkang0412/Ouroboros/src/embeddings.py", line 15, in __init__
    from sentence_transformers import SentenceTransformer
ModuleNotFoundError: No module named 'sentence_transformers'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mkkang0412/Ouroboros/train_tpu_256_112cores.py", line 160, in <module>
    main()
  File "/home/mkkang0412/Ouroboros/train_tpu_256_112cores.py", line 68, in main
    embedding_provider = get_embedding_provider(config.embedding_model)
  File "/home/mkkang0412/Ouroboros/src/embeddings.py", line 86, in get_embedding_provider
    return EmbeddingProvider(model_name)
  File "/home/mkkang0412/Ouroboros/src/embeddings.py", line 19, in __init__
    from transformers import AutoTokenizer, AutoModel
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/wandb/sdk/lib/import_hooks.py", line 182, in _exec_module
    self.loader.exec_module(module)
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/__init__.py", line 27, in <module>
    from . import dependency_versions_check
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/dependency_versions_check.py", line 57, in <module>
    require_version_core(deps[pkg])
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/utils/versions.py", line 117, in require_version_core
    return require_version(requirement, hint)
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/utils/versions.py", line 111, in require_version
    _compare_versions(op, got_ver, want_ver, requirement, pkg, hint)
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/utils/versions.py", line 44, in _compare_versions
    raise ImportError(
ImportError: huggingface-hub>=0.34.0,<1.0 is required for a normal functioning of this module, but found huggingface-hub==1.1.7.
Try: `pip install transformers -U` or `pip install -e '.[dev]'` if you're working with git main
Traceback (most recent call last):
  File "/home/mkkang0412/Ouroboros/src/embeddings.py", line 15, in __init__
    from sentence_transformers import SentenceTransformer
ModuleNotFoundError: No module named 'sentence_transformers'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mkkang0412/Ouroboros/train_tpu_256_112cores.py", line 160, in <module>
    main()
  File "/home/mkkang0412/Ouroboros/train_tpu_256_112cores.py", line 68, in main
    embedding_provider = get_embedding_provider(config.embedding_model)
  File "/home/mkkang0412/Ouroboros/src/embeddings.py", line 86, in get_embedding_provider
    return EmbeddingProvider(model_name)
  File "/home/mkkang0412/Ouroboros/src/embeddings.py", line 19, in __init__
    from transformers import AutoTokenizer, AutoModel
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/wandb/sdk/lib/import_hooks.py", line 182, in _exec_module
    self.loader.exec_module(module)
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/__init__.py", line 27, in <module>
    from . import dependency_versions_check
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/dependency_versions_check.py", line 57, in <module>
    require_version_core(deps[pkg])
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/utils/versions.py", line 117, in require_version_core
    return require_version(requirement, hint)
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/utils/versions.py", line 111, in require_version
    _compare_versions(op, got_ver, want_ver, requirement, pkg, hint)
  File "/home/mkkang0412/Ouroboros/.venv/lib/python3.10/site-packages/transformers/utils/versions.py", line 44, in _compare_versions
    raise ImportError(
ImportError: huggingface-hub>=0.34.0,<1.0 is required for a normal functioning of this module, but found huggingface-hub==1.1.7.
Try: `pip install transformers -U` or `pip install -e '.[dev]'` if you're working with git main
