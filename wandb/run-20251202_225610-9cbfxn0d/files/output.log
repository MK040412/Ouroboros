
Config (112 cores optimized):
  Devices: 112 TPU cores (v5e 256)
  Global batch size: 7168
  Batch per device: 64
  Steps per epoch: 1065
  Data loading: HuggingFace streaming + Prefetch

============================================================
WARNING:2025-12-02 22:56:11,816:jax._src.xla_bridge:798: A Google TPU may be present on this machine, but either a TPU-enabled jaxlib or libtpu is not installed. Falling back to cpu.
Available devices: 1
Device type: cpu

============================================================
Loading text embedding model...
============================================================
modules.json: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 573/573 [00:00<00:00, 3.20MB/s]
config_sentence_transformers.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 997/997 [00:00<00:00, 4.22MB/s]
README.md: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18.7k/18.7k [00:00<00:00, 42.6MB/s]
sentence_bert_config.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 58.0/58.0 [00:00<00:00, 430kB/s]
config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1.49k/1.49k [00:00<00:00, 5.81MB/s]
model.safetensors: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1.21G/1.21G [00:02<00:00, 433MB/s]
tokenizer_config.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1.16M/1.16M [00:00<00:00, 1.57MB/s]
tokenizer.model: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4.69M/4.69M [00:00<00:00, 13.6MB/s]
tokenizer.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 33.4M/33.4M [00:00<00:00, 89.0MB/s]
added_tokens.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35.0/35.0 [00:00<00:00, 255kB/s]
special_tokens_map.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 662/662 [00:00<00:00, 4.88MB/s]
config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 312/312 [00:00<00:00, 1.65MB/s]
config.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 134/134 [00:00<00:00, 966kB/s]
2_Dense/model.safetensors: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9.44M/9.44M [00:00<00:00, 20.4MB/s]
config.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 134/134 [00:00<00:00, 927kB/s]
3_Dense/model.safetensors: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9.44M/9.44M [00:00<00:00, 41.4MB/s]

============================================================
Initializing data loader (HF streaming)...
============================================================
Scanning data files...
Traceback (most recent call last):
  File "/home/mkkang0412/Ouroboros/train_tpu_256_112cores.py", line 161, in <module>
    main()
  File "/home/mkkang0412/Ouroboros/train_tpu_256_112cores.py", line 75, in main
    data_loader = Coyo11mDataLoader(
  File "/home/mkkang0412/Ouroboros/train_tpu_256.py", line 140, in __init__
    self._load_from_huggingface()
  File "/home/mkkang0412/Ouroboros/train_tpu_256.py", line 173, in _load_from_huggingface
    from datasets import load_dataset
ModuleNotFoundError: No module named 'datasets'
Traceback (most recent call last):
  File "/home/mkkang0412/Ouroboros/train_tpu_256_112cores.py", line 161, in <module>
    main()
  File "/home/mkkang0412/Ouroboros/train_tpu_256_112cores.py", line 75, in main
    data_loader = Coyo11mDataLoader(
  File "/home/mkkang0412/Ouroboros/train_tpu_256.py", line 140, in __init__
    self._load_from_huggingface()
  File "/home/mkkang0412/Ouroboros/train_tpu_256.py", line 173, in _load_from_huggingface
    from datasets import load_dataset
ModuleNotFoundError: No module named 'datasets'
